/**********************************************************************************
* File name    :	Fd12m.c
* Function     :	
* Author       : 	Footman
* Date         :	2016/11/07
* Version      :    v1.0
* Description  :	
* ModifyRecord :
**********************************************************************************/

/**********************************************************************************
* Include Header Files
**********************************************************************************/
#include "AS569.h"

/**********************************************************************************
* Local Macro Definition
**********************************************************************************/

/**********************************************************************************
* Local Type Definition
**********************************************************************************/

/**********************************************************************************
* Local static Variable Declaration
**********************************************************************************/

/**********************************************************************************
* Global Variable Declaration
**********************************************************************************/

/**********************************************************************************
* Local Functon Declaration
**********************************************************************************/

/**********************************************************************************
* Functon
**********************************************************************************/

/****************************************************************************
 * Subroutine:	Fd12m_Init
 * Function:
 * Input:		nMin ---	minimum threshold of frequency detection
				nMax ---	maximum threshold of frequency detection
				nMode ---	deal mode of frequency detection exception 	
 * Output:		RT_OK	
 * Description:	 
 * Date:		2016/11/07
 * ModifyRecord:
 * *************************************************************************/
UINT8 Fd12m_Init(UINT32 nMin, UINT32 nMax, FD12M_MODE nMode)
{
	SCM_EnableModClk(ID_FD12M);
	Fd12m_Stop();

	Fd12mRegs.MAX = nMax;
	Fd12mRegs.MIN = nMin;

	if(nMode & FD12M_SRAM) Fd12mRegs.CTRL.bit.SdEn = 1;
	if(nMode & FD12M_RESET) Fd12mRegs.CTRL.bit.RstEn = 1;	
	if(nMode & FD12M_INT) 
	{
		Fd12mRegs.CTRL.bit.IntEn = 1;
		Fd12mRegs.CTRL.bit.IntFlag = 1;
		while(Fd12mRegs.CTRL.bit.IntFlag);
		NVIC_EnableIRQ(FD12M_IRQn);
		__enable_irq();
	}
	
	return RT_OK;	
}

